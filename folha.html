<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UFF no RUF | Dashboard Completo</title>

  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Plotly JS -->
  <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --light-bg: #f8fafc;
      --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      --border-radius: 10px;
      --transition: all 0.3s ease;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--light-bg);
      color: #1f2937;
      line-height: 1.5;
      padding-top: 20px;
      padding-bottom: 40px;
    }

    .container {
      max-width: 1400px;
    }

    /* Header - Cores de degradê verde conforme solicitado */
    .dashboard-header {
      background: linear-gradient(135deg, #059669 0%, #10B981 100%);
      border-radius: var(--border-radius);
      box-shadow: var(--card-shadow);
      margin-bottom: 30px;
      padding: 30px;
      color: white;
    }

    .dashboard-header h1 {
      font-weight: 700;
      font-size: 2.2rem;
      margin-bottom: 8px;
    }

    .dashboard-header p {
      font-size: 1rem;
      opacity: 0.9;
      max-width: 800px;
    }

    .header-badge {
      background-color: rgba(255, 255, 255, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 50px;
      padding: 8px 16px;
      font-weight: 600;
      font-size: 0.9rem;
      backdrop-filter: blur(10px);
    }

    /* Cards com cores únicas */
    .indicator-card {
      border-radius: var(--border-radius);
      border: none;
      box-shadow: var(--card-shadow);
      transition: var(--transition);
      height: 100%;
      margin-bottom: 20px;
      overflow: hidden;
      border-top: 4px solid;
    }

    .indicator-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    }

    .indicator-card .card-body {
      padding: 20px;
    }

    .card-title {
      font-size: 0.9rem;
      font-weight: 600;
      color: #6b7280;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 0.3px;
    }

    .indicator-value {
      font-size: 2.2rem;
      font-weight: 700;
      margin-bottom: 5px;
      line-height: 1.1;
    }

    .card-subtitle {
      font-size: 0.85rem;
      color: #9ca3af;
      margin-bottom: 0;
    }

    .card-icon {
      font-size: 1.8rem;
      margin-bottom: 12px;
      opacity: 0.9;
    }

    /* Cores únicas para cada card */
    .card-1 {
      border-top-color: #3B82F6;
    }

    .card-1 .indicator-value {
      color: #3B82F6;
    }

    .card-1 .card-icon {
      color: #3B82F6;
    }

    .card-2 {
      border-top-color: #10B981;
    }

    .card-2 .indicator-value {
      color: #10B981;
    }

    .card-2 .card-icon {
      color: #10B981;
    }

    .card-3 {
      border-top-color: #F59E0B;
    }

    .card-3 .indicator-value {
      color: #F59E0B;
    }

    .card-3 .card-icon {
      color: #F59E0B;
    }

    .card-4 {
      border-top-color: #EF4444;
    }

    .card-4 .indicator-value {
      color: #EF4444;
    }

    .card-4 .card-icon {
      color: #EF4444;
    }

    .card-5 {
      border-top-color: #8B5CF6;
    }

    .card-5 .indicator-value {
      color: #8B5CF6;
    }

    .card-5 .card-icon {
      color: #8B5CF6;
    }

    .card-6 {
      border-top-color: #EC4899;
    }

    .card-6 .indicator-value {
      color: #EC4899;
    }

    .card-6 .card-icon {
      color: #EC4899;
    }

    .card-7 {
      border-top-color: #06D6A0;
    }

    .card-7 .indicator-value {
      color: #06D6A0;
    }

    .card-7 .card-icon {
      color: #06D6A0;
    }

    .card-8 {
      border-top-color: #118AB2;
    }

    .card-8 .indicator-value {
      color: #118AB2;
    }

    .card-8 .card-icon {
      color: #118AB2;
    }

    .card-9 {
      border-top-color: #EF4444;
    }

    .card-9 .indicator-value {
      color: #EF4444;
    }

    .card-9 .card-icon {
      color: #EF4444;
    }

    /* Section Headers */
    .section-header {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--card-shadow);
      padding: 20px;
      margin-bottom: 20px;
      border-left: 4px solid;
    }

    .classification-section {
      border-left-color: #059669;
    }

    .score-section {
      border-left-color: #3B82F6;
    }

    .section-title {
      font-weight: 700;
      font-size: 1.4rem;
      margin-bottom: 0;
      display: flex;
      align-items: center;
    }

    .section-icon {
      margin-right: 10px;
      font-size: 1.5rem;
    }

    .classification-icon {
      color: #059669;
    }

    .score-icon {
      color: #3B82F6;
    }

    /* Charts */
    .chart-container {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--card-shadow);
      padding: 20px;
      margin-bottom: 25px;
      height: 100%;
    }

    .chart-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: #1f2937;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid #e5e7eb;
    }

    .chart-notes {
      font-size: 0.85rem;
      color: #6b7280;
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid #f3f4f6;
    }

    /* Tabs */
    .chart-tabs {
      background: #f9fafb;
      border-radius: 8px;
      padding: 4px;
      margin-bottom: 15px;
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
    }

    .tab-btn {
      flex: 1;
      min-width: 100px;
      padding: 8px 12px;
      background: transparent;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      font-size: 0.65rem;
      color: #6b7280;
      transition: var(--transition);
      text-align: center;
    }

    .tab-btn:hover {
      background: #e5e7eb;
      color: #374151;
    }

    .tab-btn.active {
      background: white;
      color: #059669;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
    }

    .score-tab.active {
      color: #3B82F6;
    }

    /* Footer */
    .footer-note {
      font-size: 0.85rem;
      color: #6b7280;
      text-align: center;
      margin-top: 40px;
      padding-top: 20px;
      border-top: 1px solid #e5e7eb;
    }

    /* Responsive */
    @media (max-width: 992px) {
      .dashboard-header {
        padding: 25px;
      }

      .dashboard-header h1 {
        font-size: 1.8rem;
      }

      .indicator-value {
        font-size: 1.9rem;
      }
    }

    @media (max-width: 768px) {
      .dashboard-header h1 {
        font-size: 1.6rem;
      }

      .section-title {
        font-size: 1.2rem;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- Header -->
    <div class="dashboard-header">
      <div class="row align-items-center">
        <div class="col-lg-8">
          <h1>UFF no Ranking Universitário Folha</h1>
        </div>
      </div>
    </div>

    <!-- Cards de Classificação -->
    <div class="row mb-4">
      <div class="col-12 mb-3">
        <div class="section-header classification-section">
          <h2 class="section-title">
            <i class="fas fa-chart-line section-icon classification-icon"></i>Classificação no RUF
          </h2>
        </div>
      </div>

      <!-- Card 1: Posição no Brasil (Geral) -->
      <div class="col-md-6 col-lg-3 mb-3">
        <div class="indicator-card card-1">
          <div class="card-body text-center">
            <div class="card-icon">
              <i class="fas fa-flag"></i>
            </div>
            <h5 class="card-title">Posição no Brasil</h5>
            <div class="indicator-value">15º</div>
            <p class="card-subtitle">2025 - RUF</p>
          </div>
        </div>
      </div>

      <!-- Card 2: Posição em Ensino -->
      <div class="col-md-6 col-lg-3 mb-3">
        <div class="indicator-card card-2">
          <div class="card-body text-center">
            <div class="card-icon">
              <i class="fas fa-graduation-cap"></i>
            </div>
            <h5 class="card-title">Posição em Ensino</h5>
            <div class="indicator-value">12º</div>
            <p class="card-subtitle">2025 - RUF</p>
          </div>
        </div>
      </div>

      <!-- Card 3: Posição entre as Federais -->
      <div class="col-md-6 col-lg-3 mb-3">
        <div class="indicator-card card-3">
          <div class="card-body text-center">
            <div class="card-icon">
              <i class="fas fa-university"></i>
            </div>
            <h5 class="card-title">Entre as Federais</h5>
            <div class="indicator-value">12º</div>
            <p class="card-subtitle">2025 - RUF</p>
          </div>
        </div>
      </div>

      <!-- Card 4: Pontuação Geral -->
      <div class="col-md-6 col-lg-3 mb-3">
        <div class="indicator-card card-4">
          <div class="card-body text-center">
            <div class="card-icon">
              <i class="fas fa-star"></i>
            </div>
            <h5 class="card-title">Pontuação Geral (2025)</h5>
            <div class="indicator-value">87.8</div>
            <p class="card-subtitle">De 100 pontos possíveis</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Gráficos de Classificação -->
    <div class="row mb-5">
      <!-- Gráfico Posição no Brasil com Participantes -->
      <div class="col-lg-6 p-3 mb-3">
        <div class="chart-container">
          <h4 class="chart-title">Posição da UFF no Brasil e Nº de Universidades Participantes</h4>
          <div id="brazil-position-chart"></div>
          <!-- <div class="chart-notes">
            <i class="fas fa-info-circle me-1"></i>
            Linha: Posição da UFF (eixo esquerdo) | Barras: Nº de universidades participantes (eixo
            direito)
          </div> -->
        </div>
      </div>

      <!-- Gráfico Posição entre as Federais -->
      <div class="col-lg-6 p-3 mb-3">
        <div class="chart-container">
          <h4 class="chart-title">Posição entre as Federais</h4>
          <div id="federais-position-chart"></div>
          <!-- <div class="chart-notes">
            <i class="fas fa-info-circle me-1"></i>
            Classificação entre as universidades federais brasileiras
          </div> -->
        </div>
      </div>

      <!-- Gráfico Classificação por Indicadores com Participantes -->
      <div class="col-lg-6 mb-3">
        <div class="chart-container">
          <h4 class="chart-title">Classificação por Indicadores e Nº de Participantes</h4>
          <div class="chart-tabs mb-3">
            <button class="tab-btn active" onclick="changeClassificationTab('ensino-mercado')">Ensino & Mercado</button>
            <button class="tab-btn" onclick="changeClassificationTab('pesquisa-inovacao')">Pesquisa & Inovação</button>
            <button class="tab-btn"
              onclick="changeClassificationTab('internacionalizacao')">Internacional</button>
          </div>
          <div id="classification-chart"></div>
          <!-- <div class="chart-notes">
            <i class="fas fa-info-circle me-1"></i>
            Linhas: Posições nos indicadores | Barras: Nº de universidades participantes
            (eixo direito)
          </div> -->
        </div>
      </div>

      <!-- Gráfico Pontuação Geral -->
      <div class="col-lg-6 mb-3">
        <div class="chart-container">
          <h4 class="chart-title">Pontuação Geral da UFF no RUF</h4>
          <div id="overall-score-chart"></div>
          <!-- <div class="chart-notes">
            <i class="fas fa-info-circle me-1"></i>
            Pontuação geral no RUF (escala de 0 a 100 pontos).
          </div> -->
        </div>
      </div>
    </div>

    <!-- Cards de Pontuação -->
    <div class="row mb-4">
      <div class="col-12 mb-3">
        <div class="section-header score-section">
          <h2 class="section-title">
            <i class="fas fa-chart-bar section-icon score-icon"></i>Pontuação nos Indicadores
          </h2>
        </div>
      </div>

      <!-- Card 5: Pontuação Ensino -->
      <div class="col-md-6 col-lg-3 mb-3">
        <div class="indicator-card card-5">
          <div class="card-body text-center">
            <div class="card-icon">
              <i class="fas fa-graduation-cap"></i>
            </div>
            <h5 class="card-title">Pontuação Ensino (2025)</h5>
            <div class="indicator-value">29.6</div>
            <p class="card-subtitle">De 32 pontos possíveis</p>
          </div>
        </div>
      </div>

      <!-- Card 6: Pontuação Pesquisa -->
      <div class="col-md-6 col-lg-3 mb-3">
        <div class="indicator-card card-6">
          <div class="card-body text-center">
            <div class="card-icon">
              <i class="fas fa-flask"></i>
            </div>
            <h5 class="card-title">Pontuação Pesquisa (2025)</h5>
            <div class="indicator-value">35.6</div>
            <p class="card-subtitle">De 42 pontos possíveis</p>
          </div>
        </div>
      </div>

      <!-- Card 7: Pontuação Mercado -->
      <div class="col-md-6 col-lg-3 mb-3">
        <div class="indicator-card card-7">
          <div class="card-body text-center">
            <div class="card-icon">
              <i class="fas fa-briefcase"></i>
            </div>
            <h5 class="card-title">Pontuação Mercado (2025)</h5>
            <div class="indicator-value">16.3</div>
            <p class="card-subtitle">De 18 pontos possíveis</p>
          </div>
        </div>
      </div>

      <!-- Card 8: Pontuação Inovação -->
      <div class="col-md-6 col-lg-3 mb-3">
        <div class="indicator-card card-8">
          <div class="card-body text-center">
            <div class="card-icon">
              <i class="fas fa-lightbulb"></i>
            </div>
            <h5 class="card-title">Pontuação Inovação (2025)</h5>
            <div class="indicator-value">3.1</div>
            <p class="card-subtitle">De 4 pontos possíveis</p>
          </div>
        </div>
      </div>

      <!-- Card 9: Pontuação Internacionalização -->
      <div class="col-md-6 col-lg-3 mb-3">
        <div class="indicator-card card-9">
          <div class="card-body text-center">
            <div class="card-icon">
              <i class="fa-solid fa-earth-americas"></i>
            </div>
            <h5 class="card-title">Pontuação Internacionalização (2025)</h5>
            <div class="indicator-value">3.3</div>
            <p class="card-subtitle">De 4 pontos possíveis</p>
          </div>
        </div>
      </div>
    </div> 

    <!-- Gráficos de Pontuação -->
    <div class="row mb-4">
      <!-- Gráfico Pontuação por Indicadores -->
      <div class="col-lg-6 mb-3">
        <div class="chart-container">
          <h4 class="chart-title">Pontuação por Indicadores</h4>
          <div class="chart-tabs mb-3">
            <button class="tab-btn score-tab active" onclick="changeScoreTab('main')">Ensino & Mercado</button>
            <button class="tab-btn score-tab" onclick="changeScoreTab('research')">Pesquisa & Inovação</button>
            <button class="tab-btn score-tab" onclick="changeScoreTab('international')">Internacional</button>
          </div>
          <div id="score-chart"></div>
          <!-- <div class="chart-notes">
            <i class="fas fa-info-circle me-1"></i>
            Pontuação nos cinco indicadores do RUF
          </div> -->
        </div>
      </div>

      <!-- Gráfico Comparativo de Pontuações -->
      <div class="col-lg-6">
        <div class="chart-container mb-3">
          <h4 class="chart-title">Comparativo de Pontuações por Ano</h4>
          <div id="score-comparison-chart"></div>
          <!-- <div class="chart-notes">
            <i class="fas fa-info-circle me-1"></i>
            Evolução das pontuações nos diferentes indicadores do RUF ao longo dos anos
          </div> -->
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="footer-note">
      <p class="mb-2">
        <i class="fas fa-database me-1"></i>
        Dados do <a href="https://ruf.folha.uol.com.br/2025/" style="text-decoration: none;">Ranking Universitário Folha </a>- 2013 a 2025 (com pausa entre 2020-2022)
      </p>
      <p class="mb-0">
        <i class="fa-solid fa-arrow-trend-up me-1"></i>
        <a href="https://www.uff.br/proplan/uff-em-numeros/" target="_blank" style="text-decoration: none;">Desenvolvido
          pela PGI/PLAN - UFF</a>
      </p>
    </div>
  </div>


  <!-- JavaScript -->
  <script>
    // Dados do RUF (extraídos do Excel)
    const data = {
      // Anos disponíveis (com lacunas 2020-2022)
      years: [2013, 2014, 2015, 2016, 2017, 2018, 2019, 2023, 2024, 2025],

      // Classificação no Brasil (Geral)
      brazilPosition: [18, 16, 13, 14, 16, 16, 17, 13, 17, 15],

      // Classificação entre as Federais
      federaisPosition: [10, 13, 10, 10, 12, 12, 13, 10, 14, 12],

      // Classificação por indicadores
      ensinoPosition: [26, 18, 17, 16, 15, 14, 13, 14, 11, 12],
      pesquisaPosition: [20, 22, 18, 22, 24, 27, 27, 28, 29, 27],
      mercadoPosition: [26, 22, 14, 17, 19, 18, 17, 16, 19, 20],
      inovacaoPosition: [26, 24, 24, 29, 31, 26, 22, 25, 26, 23],
      internacionalizacaoPosition: [9, 23, 18, 26, 24, 26, 28, 42, 44, 21],

      // Pontuação
      overallScore: [83.49, 85.9, 86.8, 86.94, 86.37, 85.89, 86.66, 87.51, 87.19, 87.79],
      ensinoScore: [24.68, 27.65, 26.79, 28.12, 28.28, 28.28, 28.63, 29.59, 29.82, 29.57],
      pesquisaScore: [35.07, 35.84, 36.77, 36.04, 35.52, 35.04, 35.32, 35.14, 35.07, 35.57],
      mercadoScore: [15.55, 15.95, 16.67, 16.46, 16.27, 16.39, 16.5, 16.63, 16.38, 16.27],
      inovacaoScore: [3.0, 3.17, 3.25, 3.13, 3.09, 2.92, 3.01, 3.1, 2.87, 3.09],
      internacionalizacaoScore: [5.19, 3.29, 3.32, 3.19, 3.21, 3.26, 3.2, 3.05, 3.05, 3.29],

      // Número de universidades participantes
      participants: [192, 192, 192, 195, 195, 196, 197, 203, 203, 204]
    };

    // Cores para gráficos
    const colors = {
      blue: '#3B82F6',
      green: '#10B981',
      orange: '#F59E0B',
      red: '#EF4444',
      purple: '#8B5CF6',
      pink: '#EC4899',
      cyan: '#06D6A0',
      teal: '#118AB2',
      indigo: '#6366F1',
      yellow: '#EAB308',
      gray: '#9CA3AF',
      lightBlue: '#93C5FD',
      lightGreen: '#86EFAC',
      lightPurple: '#C4B5FD'
    };

    // Configurações do gráfico
    const chartConfig = {
      responsive: true,
      displayModeBar: false,
      displaylogo: false,
      modeBarButtonsToRemove: ['lasso2d', 'select2d'],
      toImageButtonOptions: {
        format: 'png',
        filename: 'uff-ruf-ranking',
        height: 500,
        width: 1000,
        scale: 1
      }
    };

    // Função para formatar valores
    function formatValue(val) {
      if (val === null || val === undefined) return '';
      return Number.isInteger(val) ? val.toString() : val.toFixed(1);
    }

    // Layout comum
    const commonLayout = {
      paper_bgcolor: 'rgba(0,0,0,0)',
      plot_bgcolor: 'rgba(0,0,0,0)',
      font: {
        family: 'Inter, sans-serif',
        color: '#1f2937'
      },
      margin: { t: 40, r: 30, b: 60, l: 60 },
      hovermode: 'closest',
      showlegend: true,
      legend: {
        orientation: 'h',
        y: -0.25,
        x: 0.5,
        xanchor: 'center',
        bgcolor: 'rgba(255, 255, 255, 0.9)',
        bordercolor: 'rgba(0,0,0,0.1)',
        borderwidth: 1
      },
      xaxis: {
        fixedrange: true,
        gridcolor: 'rgba(0,0,0,0.03)',
        showgrid: true,
        showline: true,
        linecolor: 'rgba(0,0,0,0.1)',
        linewidth: 1,
        tickmode: 'array',
        tickvals: data.years,
        tickformat: 'd',
        tickfont: {
          size: 10,
          color: '#6b7280'
        },
        title: {
          text: 'Ano',
          font: {
            size: 11,
            color: '#6b7280'
          }
        }
      },
      yaxis: {
        fixedrange: true,
        gridcolor: 'rgba(0,0,0,0.03)',
        showgrid: true,
        showline: true,
        linecolor: 'rgba(0,0,0,0.1)',
        linewidth: 1,
        tickfont: {
          size: 10,
          color: '#6b7280'
        },
        title: {
          font: {
            size: 11,
            color: '#6b7280'
          }
        }
      }
    };

    // Layout para gráficos de posição (menor = melhor)
    const positionLayout = {
      ...commonLayout,
      yaxis: {
        ...commonLayout.yaxis,
        autorange: 'reversed',
        title: 'Posição (menor = melhor)',
        tickformat: 'd',
        nticks: 6
      }
    };

    // Layout para gráficos de pontuação
    const scoreLayout = {
      ...commonLayout,
      yaxis: {
        ...commonLayout.yaxis,
        title: 'Pontuação',
        tickformat: '.2f',
        nticks: 6
      }
    };

    // Inicializar gráficos
    function initCharts() {
      // 1. Gráfico Posição no Brasil com Participantes (com labels de posição)
      createBrazilPositionChart();

      // 2. Gráfico Posição entre as Federais
      createFederaisPositionChart();

      // 3. Gráfico Pontuação Geral
      createOverallScoreChart();

      // 4. Gráfico Comparativo de Pontuações
      createScoreComparisonChart();

      // 5. Gráficos de indicadores (com abas)
      createClassificationChart('ensino-mercado');
      createScoreChart('main');
    }

    // 1. Gráfico Posição no Brasil com Participantes (labels ABAIXO à direita dos pontos)
    function createBrazilPositionChart() {
      // Traço da linha (posição) com annotation labels ABAIXO à direita
      const positionLineTrace = {
        x: data.years,
        y: data.brazilPosition,
        type: 'scatter',
        mode: 'lines+markers+text',
        name: 'Posição da UFF',
        line: {
          color: colors.lightBlue,
          width: 4,
          shape: 'spline'
        },
        marker: {
          color: colors.lightBlue,
          size: 10,
          line: {
            color: 'white',
            width: 2
          }
        },
        text: data.brazilPosition.map(v => v.toString() + ''),
        textposition: 'bottom center',
        textfont: {
          size: 8,
          color: colors.blue,
          family: 'Inter, sans-serif',
          weight: 'bold'
        },
        hovertemplate: '<b>Ano:</b> %{x}<br><b>Posição:</b> %{y}º<extra></extra>',
        yaxis: 'y1'
      };

      // Traço das barras (participantes) com labels visíveis
      const participantsBarTrace = {
        x: data.years,
        y: data.participants,
        text: data.participants.map(v => v.toString()),
        textposition: 'outside',
        textfont: {
          size: 8,
          color: colors.gray,
          family: 'Inter, sans-serif'
        },
        type: 'bar',
        name: 'Nº de Universidades   ',
        marker: {
          color: colors.lightBlue,
          opacity: 0.4,
          line: {
            color: colors.blue,
            width: 1
          }
        },
        hovertemplate: '<b>Ano:</b> %{x}<br><b>Nº de Universidades:</b> %{y}<extra></extra>',
        yaxis: 'y2'
      };

      // Layout para gráfico combinado
      const participantsLayout = {
        ...commonLayout,
        title: '',
        yaxis: {
          ...commonLayout.yaxis,
          autorange: 'reversed',
          title: 'Posição da UFF (menor = melhor)',
          tickformat: 'd',
          nticks: 6,
          side: 'left',
          showgrid: false
        },
        yaxis2: {
          fixedrange: true,
          title: 'Nº de participantes',
          overlaying: 'y',
          side: 'right',
          tickformat: 'd',
          nticks: 5,
          gridcolor: 'rgba(0,0,0,0.03)',
          showgrid: true,
          linecolor: 'rgba(0,0,0,0.1)',
          linewidth: 1,
          tickfont: {
            size: 10,
            color: colors.gray
          },
        },
        legend: {
          ...commonLayout.legend,
          y: -0.3
        },
        margin: {
          ...commonLayout.margin,
          r: 80,
          b: 80
        }
      };

      Plotly.newPlot('brazil-position-chart', [positionLineTrace, participantsBarTrace], participantsLayout, chartConfig);
    }

    // 2. Gráfico Posição entre as Federais
    function createFederaisPositionChart() {
      const federaisPositionTrace = {
        x: data.years,
        y: data.federaisPosition,
        type: 'scatter',
        mode: 'lines+markers+text',
        name: 'Entre as Federais',
        line: {
          color: colors.green,
          width: 4,
          shape: 'spline'
        },
        marker: {
          color: colors.green,
          size: 10,
          line: {
            color: 'white',
            width: 2
          }
        },
        text: data.federaisPosition.map(v => v.toString() + ''),
        textposition: 'top center',
        textfont: {
          size: 8,
          color: colors.green,
          family: 'Inter, sans-serif',
          weight: 'bold'
        },
        hovertemplate: '<b>Ano:</b> %{x}<br><b>Posição entre Federais:</b> %{y}º<extra></extra>'
      };

      Plotly.newPlot('federais-position-chart', [federaisPositionTrace], {
        ...positionLayout,
        title: ''
      }, chartConfig);
    }

    // 3. Gráfico Pontuação Geral
    function createOverallScoreChart() {
      const overallScoreTrace = {
        x: data.years,
        y: data.overallScore,
        type: 'scatter',
        mode: 'lines+markers+text',
        name: 'Pontuação Geral',
        line: {
          color: colors.purple,
          width: 4,
          shape: 'spline'
        },
        marker: {
          color: colors.purple,
          size: 10,
          line: {
            color: 'white',
            width: 2
          }
        },
        text: data.overallScore.map(v => v.toFixed(1)),
        textposition: 'top center',
        textfont: {
          size: 8,
          color: colors.purple,
          family: 'Inter, sans-serif',
          weight: 'bold'
        },
        hovertemplate: '<b>Ano:</b> %{x}<br><b>Pontuação Geral:</b> %{y}<extra></extra>'
      };

      Plotly.newPlot('overall-score-chart', [overallScoreTrace], {
        ...scoreLayout,
        title: ''
      }, chartConfig);
    }

    // 4. Gráfico Comparativo de Pontuações (SEM annotation labels)
    function createScoreComparisonChart() {
      const scoreComparisonTraces = [
        createTrace(data.years, data.ensinoScore, 'Ensino', colors.blue, 3, '', false, 'solid'),
        createTrace(data.years, data.pesquisaScore, 'Pesquisa', colors.green, 3, '', false, 'solid'),
        createTrace(data.years, data.mercadoScore, 'Mercado', colors.orange, 3, '', false, 'solid'),
        createTrace(data.years, data.inovacaoScore, 'Inovação', colors.purple, 2.5, '', false, 'dash'),
        createTrace(data.years, data.internacionalizacaoScore, 'Internacionalização   ', colors.red, 2.5, '', false, 'dot')
      ];

      Plotly.newPlot('score-comparison-chart', scoreComparisonTraces, {
        ...scoreLayout,
        title: '',
        yaxis: {
          ...scoreLayout.yaxis,
          title: 'Pontuação'
        }
      }, chartConfig);
    }

    // Função para criar gráfico de classificação por indicadores COM participantes e NOVAS abas
    function createClassificationChart(tab) {
      const years = data.years;
      let lineTraces = [];

      if (tab === 'ensino-mercado') {
        // Aba: Ensino e Mercado
        lineTraces = [
          createTrace(years, data.ensinoPosition, 'Ensino', colors.blue, 3, '', true, 'solid', 'bottom center'),
          createTrace(years, data.mercadoPosition, 'Mercado', colors.orange, 3, '', true, 'solid', 'bottom center')
        ];
      } else if (tab === 'pesquisa-inovacao') {
        // Aba: Pesquisa & Inovação
        lineTraces = [
          createTrace(years, data.pesquisaPosition, 'Pesquisa', colors.green, 3, '', true, 'solid', 'bottom center'),
          createTrace(years, data.inovacaoPosition, 'Inovação', colors.purple, 3, '', true, 'solid', 'top center')
        ];
      } else if (tab === 'internacionalizacao') {
        // Aba: Internacionalização (APENAS internacionalização)
        lineTraces = [
          createTrace(years, data.internacionalizacaoPosition, 'Internacionalização', colors.red, 3, '', true, 'solid', 'bottom center')
        ];
      }

      // Traço das barras (participantes)
      const participantsBarTrace = {
        x: data.years,
        y: data.participants,
        text: data.participants.map(v => v.toString()),
        textposition: 'outside',
        textfont: {
          size: 10,
          color: colors.gray,
          family: 'Inter, sans-serif'
        },
        type: 'bar',
        name: 'Nº de Universidades   ',
        marker: {
          color: colors.lightBlue,
          opacity: 0.3,
          line: {
            color: colors.blue,
            width: 1
          }
        },
        hovertemplate: '<b>Ano:</b> %{x}<br><b>Nº de Universidades:</b> %{y}<extra></extra>',
        yaxis: 'y2'
      };

      const allTraces = [...lineTraces, participantsBarTrace];

      // Layout para gráfico combinado
      const classificationLayout = {
        ...commonLayout,
        title: '',
        yaxis: {
          ...commonLayout.yaxis,
          autorange: 'reversed',
          title: 'Posição (menor = melhor)',
          tickformat: 'd',
          nticks: 6,
          side: 'left',
          showgrid: false
        },
        yaxis2: {
          fixedrange: true,
          title: 'Nº de participantes',
          overlaying: 'y',
          side: 'right',
          tickformat: 'd',
          nticks: 5,
          gridcolor: 'rgba(0,0,0,0.03)',
          showgrid: false,
          linecolor: 'rgba(0,0,0,0.1)',
          linewidth: 1,
          tickfont: {
            size: 10,
            color: colors.gray
          },
        },
        legend: {
          ...commonLayout.legend,
          y: -0.35
        },
        margin: {
          ...commonLayout.margin,
          r: 80,
          b: 80
        }
      };

      Plotly.newPlot('classification-chart', allTraces, classificationLayout, chartConfig);
    }

    // Função para criar gráfico de pontuação por indicadores (com abas)
    function createScoreChart(tab) {
      const years = data.years;
      let traces = [];

      if (tab === 'main') {
        // Principais indicadores
        traces = [
          createTrace(years, data.ensinoScore, 'Ensino', colors.blue, 3, '', true, 'solid', 'top center'),
          //createTrace(years, data.pesquisaScore, 'Pesquisa', colors.green, 3, '', true, 'solid', 'top center'),
          createTrace(years, data.mercadoScore, 'Mercado', colors.orange, 3, '', true, 'solid', 'top center')
        ];
      } else if (tab === 'research') {
        // Indicadores de pesquisa
        traces = [
          createTrace(years, data.pesquisaScore, 'Pesquisa', colors.green, 3, '', true, 'solid', 'top center'),
          createTrace(years, data.inovacaoScore, 'Inovação', colors.purple, 3, '', true, 'solid', 'top center')
        ];
      } else if (tab === 'international') {
        // Internacionalização
        traces = [
          createTrace(years, data.internacionalizacaoScore, 'Internacionalização', colors.red, 3, '', true, 'solid', 'top center')
        ];
      }

      Plotly.newPlot('score-chart', traces, {
        ...scoreLayout,
        title: ''
      }, chartConfig);
    }

    // Função auxiliar para criar traços
    function createTrace(x, y, name, color, width, suffix, showText, lineDash, textPosition) {
      const trace = {
        x: x,
        y: y,
        type: 'scatter',
        mode: 'lines+markers',
        name: name,
        line: {
          color: color,
          width: width,
          shape: 'spline',
          dash: lineDash || 'solid'
        },
        marker: {
          color: color,
          size: 8,
          line: {
            color: 'white',
            width: 1
          }
        },
        hovertemplate: `<b>${name}:</b> %{y}${suffix}<br><b>Ano:</b> %{x}<extra></extra>`
      };

      if (showText) {
        trace.mode = 'lines+markers+text';
        trace.text = y.map(v => formatValue(v) + suffix);
        trace.textposition = textPosition || 'top center';
        trace.textfont = {
          size: 8,
          color: color,
          family: 'Inter, sans-serif'
        };
      }

      return trace;
    }

    // Funções para trocar abas - CORRIGIDAS
    function changeClassificationTab(tab) {
      const chartContainer = document.getElementById('classification-chart').closest('.chart-container');
      const tabBtns = chartContainer.querySelectorAll('.tab-btn');

      // Remover classe active de todos os botões
      tabBtns.forEach(btn => btn.classList.remove('active'));

      // Encontrar e ativar o botão correto
      let found = false;
      tabBtns.forEach(btn => {
        const btnText = btn.textContent.trim().toLowerCase();
        if (!found) {
          if (tab === 'ensino-mercado' && btnText.includes('ensino')) {
            btn.classList.add('active');
            found = true;
          } else if (tab === 'pesquisa-inovacao' && btnText.includes('pesquisa')) {
            btn.classList.add('active');
            found = true;
          } else if (tab === 'internacionalizacao' && btnText.includes('internacional')) {
            btn.classList.add('active');
            found = true;
          }
        }
      });

      // Se não encontrou, ativar o primeiro
      if (!found && tabBtns.length > 0) {
        tabBtns[0].classList.add('active');
      }

      createClassificationChart(tab);
    }

    function changeScoreTab(tab) {
      const chartContainer = document.getElementById('score-chart').closest('.chart-container');
      const tabBtns = chartContainer.querySelectorAll('.tab-btn');

      // Remover classe active de todos os botões
      tabBtns.forEach(btn => btn.classList.remove('active'));

      // Encontrar e ativar o botão correto
      let found = false;
      tabBtns.forEach(btn => {
        const btnText = btn.textContent.trim().toLowerCase();
        if (!found) {
          if (tab === 'main' && btnText.includes('ensino')) {
            btn.classList.add('active');
            found = true;
          } else if (tab === 'research' && btnText.includes('pesquisa')) {
            btn.classList.add('active');
            found = true;
          } else if (tab === 'international' && btnText.includes('internacional')) {
            btn.classList.add('active');
            found = true;
          }
        }
      });

      // Se não encontrou, ativar o primeiro
      if (!found && tabBtns.length > 0) {
        tabBtns[0].classList.add('active');
      }

      createScoreChart(tab);
    }

    // Inicializar
    document.addEventListener('DOMContentLoaded', function () {
      initCharts();
    });
  </script>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>
